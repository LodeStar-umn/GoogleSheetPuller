<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Example Google Sheet</title>
</head>

<body>
	<h1>Example Google Sheet</h1>

	<h2>List of Sheet IDs</h2>
	<div id="listSheetIDs"></div>
	<hr>
	<h2>Simple example</h2>
	<div id="results-SampleSheet"></div>
	<hr >
	<h2>Callback example</h2>

	<div id="results-SampleSheet2"></div>

	<hr >

	<h2>Jquery example</h2>
	<div id="results-SampleSheet3"></div>


	<hr>
	<div> <p>END of examples</p></div>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript" src="displayGoogleSheet.js"></script>
	<script>


	// Get list of sheet Ids and place in the console.
	getGoogleSheetList({'docId':'1JgVXA3ud90wpxqMmwMsc1ejlLsTKjjZKW5aDtZzB-Qg'});


	// Get list of sheet Ids and display above
	getGoogleSheetList({
		'docId':'1JgVXA3ud90wpxqMmwMsc1ejlLsTKjjZKW5aDtZzB-Qg'
		,'testing':false
		,'getDataClean':function(results){
			var html="<table><tr><th>sheetId</th><th>Sheet Name</th><th>Sheet API URL</th></tr>";
			for(var i=0;i<results.length;i++){
				html+="<tr>";
				html+="<td>"+results[i].sheetId+"</td>";
				html+="<td>"+results[i].sheetName+"</td>";
				html+="<td><a href='"+results[i].url+"'>"+results[i].url+"</a></td>";
				html+="</tr>";
			}
			html+="</table>";

			document.getElementById('listSheetIDs').innerHTML=html;



		}

	})



	// Simple Example
	displayGoogleSheet({
			'docId':'1JgVXA3ud90wpxqMmwMsc1ejlLsTKjjZKW5aDtZzB-Qg',
			'sheetId':'od6',
			'containingObj':document.getElementById('results-SampleSheet')
		});


	//Callback example
	displayGoogleSheet({
			'docId':'1JgVXA3ud90wpxqMmwMsc1ejlLsTKjjZKW5aDtZzB-Qg',
			'sheetId':'od6',
			'getDataClean':function(cleanResults){
				//console.log(cleanResults);
				var HTML="<ul>";
				/*return simplified version:
						[
						{'column':'data row1', 'column','data row1', 'column':'data row1'},  
						{'column':'data row2', 'column','data row2', 'column':'data row2'},   ...
					]*/
				
				for(var i=0;i<cleanResults.length;i++){
					HTML+="<li>"+cleanResults[i].Color+" "+cleanResults[i].Number+"</li>";
				}
				HTML+="</ul>";
				
				document.getElementById('results-SampleSheet2').innerHTML=HTML;

			}
		});


	//jQuery example
	$('#results-SampleSheet3').displayGoogleSheet({
		'docId':'1JgVXA3ud90wpxqMmwMsc1ejlLsTKjjZKW5aDtZzB-Qg',
		'success':function(){console.log("success using jQuery plugin");}
	}).css('background-color','#fcc'); 





	</script>
</body>

</html>
